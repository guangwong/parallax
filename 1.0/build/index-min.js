/*!build time : 2014-05-29 10:26:25 PM*/
KISSY.add("gallery/parallax/1.0/helpers",function(){function a(a){for(var b=document.createElement("div"),c=!1,d=null,e=!1,g=null,h=null,i=0,j=f.length;j>i;i++)if(null!==f[i]?(g=f[i][0]+"transform",h=f[i][1]+"Transform"):(g="transform",h="transform"),void 0!==b.style[h]){c=!0;break}switch(a){case"2D":e=c;break;case"3D":if(c){var k=document.body||document.createElement("body"),l=document.documentElement,m=l.style.overflow;document.body||(l.style.overflow="hidden",l.appendChild(k),k.style.overflow="hidden",k.style.background=""),k.appendChild(b),b.style[h]="translate3d(1px,1px,1px)",d=window.getComputedStyle(b).getPropertyValue(g),e=void 0!==d&&d.length>0&&"none"!==d,l.style.overflow=m,k.removeChild(b)}}return e}function b(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})}function c(a,c,d){for(var e,g=0,h=f.length;h>g&&(e=null!==f[g]?b(f[g][1]+"-"+c):c,void 0===a.style[e]);g++);a.style[e]=d}function d(a){for(var b=0,d=a.length;d>b;b++){var e=a[b];c(e,"transform","translate3d(0,0,0)"),c(e,"transform-style","preserve-3d"),c(e,"backface-visibility","hidden")}}var e={},f=[null,["-webkit-","webkit"],["-moz-","Moz"],["-o-","O"],["-ms-","ms"]];e.transformSupport=a,e.css=c,e.accelerate3D=d;var g,h;return function(){for(var a=0,b=["ms","moz","webkit","o"],c=window.requestAnimationFrame,d=window.cancelAnimationFrame,e=0;e<b.length&&!c;++e)c=window[b[e]+"RequestAnimationFrame"],d=window[b[e]+"CancelAnimationFrame"]||window[b[e]+"CancelRequestAnimationFrame"];g=c||function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e},h=d||function(a){clearTimeout(a)}}(),e.requestAnimationFrame=g,e.cancelAnimationFrame=h,e},{requires:["dom"]}),KISSY.add("gallery/parallax/1.0/index",function(a,b,c,d,e,f){"use strict";function g(b,c){{var d=a.all(b);this.element=d[0]}this.$context=d,this.$layers=this.$context.all(".layer"),this.$window=a.all(window),a.mix(this,a.mix(a.clone(h),c)),this.calibrationTimer=null,this.enabled=!1,this.layersCache=[],this.raf=null,this.bounds=null,this.ex=0,this.ey=0,this.ew=0,this.eh=0,this.ecx=0,this.ecy=0,this.erx=0,this.ery=0,this.ix=0,this.iy=0,this.mx=0,this.my=0,this.vx=0,this.vy=0,this.onMouseMove=a.bind(this.onMouseMove,this),this.onWindowResize=a.bind(this.onWindowResize,this),this.doUpdateBounds=a.throttle(this.updateBounds,500,this),this.onAnimationFrame=a.bind(this.onAnimationFrame,this),this.initialise()}var h={calibrationDelay:500,scalarX:10,scalarY:10,frictionX:.1,frictionY:.1,originX:.5,originY:.5},i=f.requestAnimationFrame,j=f.cancelAnimationFrame;return g.prototype.ww=null,g.prototype.wh=null,g.prototype.wcx=null,g.prototype.wcy=null,g.prototype.wrx=null,g.prototype.wry=null,g.prototype.transform2DSupport=f.transformSupport("2D"),g.prototype.transform3DSupport=f.transformSupport("3D"),g.prototype.initialise=function(){"static"===this.$context.css("position")&&this.$context.css({position:"relative"}),f.accelerate3D(this.$context),this.updateLayers(),this.updateDimensions(),this.updateBounds(),this.enable()},g.prototype.updateLayers=function(){this.$layers=this.$context.all(".layer"),this.layersCache=[],this.$layers.css({position:"absolute",display:"block",left:0,top:0}),this.$layers.slice(0,1).css({position:"relative"}),f.accelerate3D(this.$layers),this.$layers.each(a.bind(function(b){var c=a.all(b),d=parseFloat(c.attr("data-depth"),10),e=parseFloat(c.attr("data-limit-y"),10),f=parseFloat(c.attr("data-limit-x"),10);this.layersCache.push({depth:d||0,limitY:e||null,limitX:f||null})},this))},g.prototype.updateDimensions=function(){this.ww=this.$window.width(),this.wh=this.$window.height(),this.wcx=this.ww*this.originX,this.wcy=this.wh*this.originY,this.wrx=Math.max(this.wcx,this.ww-this.wcx),this.wry=Math.max(this.wcy,this.wh-this.wcy)},g.prototype.updateBounds=function(){var a=this.$context,b=a.offset();this.bounds={left:b.left,top:b.top,width:a.width(),height:a.height()},this.ex=this.bounds.left,this.ey=this.bounds.top,this.ew=this.bounds.width,this.eh=this.bounds.height,this.ecx=this.ew*this.originX,this.ecy=this.eh*this.originY,this.erx=Math.max(this.ecx,this.ew-this.ecx),this.ery=Math.max(this.ecy,this.eh-this.ecy)},g.prototype.enable=function(){this.enabled||(this.enabled=!0,d.on(document,"mousemove",this.onMouseMove),d.on(window,"resize",this.onWindowResize),d.on(window,"resize",this.doUpdateBounds),d.on(window,"scroll",this.doUpdateBounds),this.raf=i(this.onAnimationFrame))},g.prototype.disable=function(){this.enabled&&(this.enabled=!1,d.detach("mousemove",this.onMouseMove),d.detach("resize",this.onWindowResize),d.detach(window,"resize",this.doUpdateBounds),d.detach(window,"scroll",this.doUpdateBounds),j(this.raf))},g.prototype.setPosition=function(a,b,c){b+="px",c+="px",this.transform3DSupport?f.css(a,"transform","translate3d("+b+","+c+",0)"):this.transform2DSupport?f.css(a,"transform","translate("+b+","+c+")"):(a.style.left=b,a.style.top=c)},g.prototype.onWindowResize=function(){this.updateDimensions()},g.prototype.onAnimationFrame=function(){this.mx=this.ix*this.ew*(this.scalarX/100)*-1,this.my=this.iy*this.eh*(this.scalarY/100)*-1;var a=(this.mx-this.vx)*this.frictionX,b=(this.my-this.vy)*this.frictionY;this.vx+=a,this.vy+=b;for(var c=0,d=this.$layers.length;d>c;c++){var e=this.layersCache[c].depth,f=this.layersCache[c].limitX,g=this.layersCache[c].limitY,h=this.$layers[c],j=this.vx*e,k=this.vy*e;f&&j>0&&(j=Math.min(f,j)),f&&0>j&&(j=Math.max(-f,j)),g&&k>0&&(k=Math.min(g,k)),g&&0>k&&(k=Math.max(-g,k)),this.setPosition(h,j,k)}this.raf=i(this.onAnimationFrame)},g.prototype.onMouseMove=function(a){var b=a.clientX,c=a.clientY;this.ix=(b-this.wcx)/this.wrx,this.iy=(c-this.wcy)/this.wry},g},{requires:["node","dom","event","json","./helpers"]});