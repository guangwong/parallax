/*!build time : 2014-05-26 11:45:19 PM*/
KISSY.add("gallery/parallax/1.0/helpers",["dom"],function(a,b,c,d){function e(a){for(var b=document.createElement("div"),c=!1,d=null,e=!1,f=null,g=null,i=0,j=h.length;j>i;i++)if(null!==h[i]?(f=h[i][0]+"transform",g=h[i][1]+"Transform"):(f="transform",g="transform"),void 0!==b.style[g]){c=!0;break}switch(a){case"2D":e=c;break;case"3D":if(c){var k=document.body||document.createElement("body"),l=document.documentElement,m=l.style.overflow;document.body||(l.style.overflow="hidden",l.appendChild(k),k.style.overflow="hidden",k.style.background=""),k.appendChild(b),b.style[g]="translate3d(1px,1px,1px)",d=window.getComputedStyle(b).getPropertyValue(f),e=void 0!==d&&d.length>0&&"none"!==d,l.style.overflow=m,k.removeChild(b)}}return e}function f(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];g.css(d,"transform","translate3d(0,0,0)"),g.css(d,"transform-style","preserve-3d"),g.css(d,"backface-visibility","hidden")}}var g=b("dom"),h=[null,["-webkit-","webkit"],["-moz-","Moz"],["-o-","O"],["-ms-","ms"]];d.exports.transformSupport=e,d.exports.accelerate3D=f;var i,j;!function(){for(var a=0,b=["ms","moz","webkit","o"],c=window.requestAnimationFrame,d=window.cancelAnimationFrame,e=0;e<b.length&&!c;++e)c=window[b[e]+"RequestAnimationFrame"],d=window[b[e]+"CancelAnimationFrame"]||window[b[e]+"CancelRequestAnimationFrame"];i=c||function(b){var c=(new Date).getTime(),d=Math.max(0,16-(c-a)),e=window.setTimeout(function(){b(c+d)},d);return a=c+d,e},j=d||function(a){clearTimeout(a)}}(),d.exports.requestAnimationFrame=i,d.exports.cancelAnimationFrame=j}),KISSY.add("gallery/parallax/1.0/index",["node","dom","event","./helpers"],function(a,b){"use strict";function c(b,c){{var d=a.all(b);this.element=d[0]}this.$context=d,this.$layers=this.$context.all(".layer"),a.mix(this,a.mix(a.clone(g),c)),this.calibrationTimer=null,this.enabled=!1,this.layersCache=[],this.raf=null,this.bounds=null,this.ex=0,this.ey=0,this.ew=0,this.eh=0,this.ecx=0,this.ecy=0,this.erx=0,this.ery=0,this.ix=0,this.iy=0,this.mx=0,this.my=0,this.vx=0,this.vy=0,this.onMouseMove=a.bind(this.onMouseMove,this),this.onWindowResize=a.bind(this.onWindowResize,this),this.onAnimationFrame=a.bind(this.onAnimationFrame,this),this.initialise()}var d=(b("node"),b("dom")),e=b("event"),f=b("./helpers"),g={calibrationDelay:500,scalarX:10,scalarY:10,frictionX:.1,frictionY:.1,originX:.5,originY:.5},h=f.requestAnimationFrame,i=f.cancelAnimationFrame;return c.prototype.ww=null,c.prototype.wh=null,c.prototype.wcx=null,c.prototype.wcy=null,c.prototype.wrx=null,c.prototype.wry=null,c.prototype.transform2DSupport=f.transformSupport("2D"),c.prototype.transform3DSupport=f.transformSupport("3D"),c.prototype.initialise=function(){"static"===this.$context.css("position")&&this.$context.css({position:"relative"}),f.accelerate3D(this.$context),this.updateLayers(),this.updateDimensions(),this.enable(),this.queueCalibration(this.calibrationDelay)},c.prototype.updateLayers=function(){this.$layers=this.$context.all(".layer"),this.layersCache=[],this.$layers.css({position:"absolute",display:"block",left:0,top:0}),this.$layers.slice(0,1).css({position:"relative"}),f.accelerate3D(this.$layers),this.$layers.each(a.bind(function(b){var c=a.all(b),d=parseFloat(c.attr("data-depth"),10),e=parseFloat(c.attr("data-limit-y"),10),f=parseFloat(c.attr("data-limit-x"),10);this.layersCache.push({depth:d||0,limitY:e||null,limitX:f||null})},this))},c.prototype.updateDimensions=function(){this.ww=window.innerWidth,this.wh=window.innerHeight,this.wcx=this.ww*this.originX,this.wcy=this.wh*this.originY,this.wrx=Math.max(this.wcx,this.ww-this.wcx),this.wry=Math.max(this.wcy,this.wh-this.wcy)},c.prototype.updateBounds=function(){this.bounds=this.element.getBoundingClientRect(),this.ex=this.bounds.left,this.ey=this.bounds.top,this.ew=this.bounds.width,this.eh=this.bounds.height,this.ecx=this.ew*this.originX,this.ecy=this.eh*this.originY,this.erx=Math.max(this.ecx,this.ew-this.ecx),this.ery=Math.max(this.ecy,this.eh-this.ecy)},c.prototype.queueCalibration=function(a){clearTimeout(this.calibrationTimer),this.calibrationTimer=setTimeout(this.onCalibrationTimer,a)},c.prototype.enable=function(){this.enabled||(this.enabled=!0,e.on(window,"mousemove",this.onMouseMove),e.on(window,"resize",this.onWindowResize),this.raf=h(this.onAnimationFrame))},c.prototype.disable=function(){this.enabled&&(this.enabled=!1,window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("resize",this.onWindowResize),i(this.raf))},c.prototype.setPosition=function(a,b,c){b+="px",c+="px",this.transform3DSupport?d.css(a,"transform","translate3d("+b+","+c+",0)"):this.transform2DSupport?d.css(a,"transform","translate("+b+","+c+")"):(a.style.left=b,a.style.top=c)},c.prototype.onWindowResize=function(){this.updateDimensions()},c.prototype.onAnimationFrame=function(){this.updateBounds(),this.mx=this.ix*this.ew*(this.scalarX/100)*-1,this.my=this.iy*this.eh*(this.scalarY/100)*-1;var a=(this.mx-this.vx)*this.frictionX,b=(this.my-this.vy)*this.frictionY;if(this.vx+=a,this.vy+=b,Math.abs(a)>.01&&Math.abs(b)>.01)for(var c=0,d=this.$layers.length;d>c;c++){var e=this.layersCache[c].depth,f=this.layersCache[c].limitX,g=this.layersCache[c].limitY,i=this.$layers[c],j=this.vx*e,k=this.vy*e;f&&j>0&&(j=Math.min(f,j)),f&&0>j&&(j=Math.max(-f,j)),g&&k>0&&(k=Math.min(g,k)),g&&0>k&&(k=Math.max(-g,k)),this.setPosition(i,j,k)}this.raf=h(this.onAnimationFrame)},c.prototype.onMouseMove=function(a){var b=a.clientX,c=a.clientY;this.ix=(b-this.wcx)/this.wrx,this.iy=(c-this.wcy)/this.wry},c});